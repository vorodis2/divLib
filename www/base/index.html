<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="divLib.js"></script>
    <script type="module">
        import {CamZI} from "./CamZI.js";
        import {Debag} from "./Debag.js";

        var trace = window.console.log.bind(window.console);
        var dCont, scane, ddCont, dCont2, dContBtn;
        var dcmParam, camZI;
        var aa=[];

        async function open (url) {
            for(var i=0;i<aa.length;i++){
                if(aa[i].text==url)aa[i].alpha=0.5;
                else aa[i].alpha=1;
            }
            camZI.load(url);
	    }
        
        function init() {
            var otstup=2;     
            var scale = 1;
            dcmParam=new DCM();
            scane= new DCont(document.body);
            dCont = new DCont(scane);
            dContBtn = new DCont(document.body);
            ddCont=new DCont(scane);

            camZI=new CamZI(function(s,p,p1){trace(s,p,p1)});
            camZI.debag = new Debag(ddCont, otstup, 600, 10);
            camZI.debag1 = new Debag(ddCont, otstup, 700, 10);

            var yy=otstup;
            aa.push(new DButton(dContBtn,otstup,yy,"path.jpg",function(){open(this.text)}));
            yy+=32+otstup;
            aa.push(new DButton(dContBtn,otstup,yy,"norm.jpg",function(){open(this.text)}));
            yy+=32+otstup;
            aa.push(new DButton(dContBtn,otstup,yy,"mini.jpg",function(){open(this.text)}));
            yy+=32*2+otstup;
            aa.push(new DButton(dContBtn,otstup,yy,"isZI",function(){camZI.isSI()}));
            yy+=32+otstup;
            aa.push(new DButton(dContBtn,otstup,yy,"create",function(){camZI.create()}));
            yy+=32+otstup;
            aa.push(new DButton(dContBtn,otstup,yy,"normal",function(){
                let ar;
                
                ar = camZI.getArr(0, 0, camZI.bmp._width/2, camZI.bmp._height);
                camZI.mirroX(0, 0, ar, true);
                ar = camZI.getArr(0, 0, camZI.bmp._width/2, camZI.bmp._height);
                camZI.mirroY(0, 0, ar, true);
            }));
            yy+=32+otstup;
            
            dCont.div.appendChild(camZI.bmp.canvas);
            scane.add(camZI.dCont);

            camZI.bmp.canvas.style.position = 'fixed';
		    camZI.bmp.canvas.style.top = '0px';
            camZI.bmp.canvas.style.left = '0px';
        
            dCont.scale=scale;
            dCont.x=200;

            open(aa[0].text);

            // setTimeout(function(){
                // let ar;
                
                // ar = camZI.getArr(0, 0, camZI.bmp._width/2, camZI.bmp._height);
                // camZI.mirroX(0, 0, ar, true);
                // ar = camZI.getArr(0, 0, camZI.bmp._width/2, camZI.bmp._height);
                // camZI.mirroY(0, 0, ar, true);
            // }, 50)
        }

        setTimeout(function(){init()},100);
    </script>
</head>
<body">  
</body>
</html>